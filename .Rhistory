ca<-Cardiology$ca
thal<-Cardiology$thal
class<-Cardiology$class
#Change to factor if needed
class<-factor(class)
cp<-factor(cp)
bSugar<-factor(bSugar)
exang<-factor(exang)
slope<-factor(slope)
ca<-factor(ca)
thal<-factor(thal)
sex<-factor(sex)
restecg<-factor(restecg)
table(sex)
sex[sex == "f"]<-"Female"
sex[sex == "m"]<-"Male"
cp[cp == " Asymptomatic"] <- "Asymptomatic"
table(Heart$sex)
table(Heart$cp)
Heart<-data.frame(age,
sex,
cp,
trestbps,
cholestral,
bSugar,
diastbpererc,
thalach,
exang,
oldpeak,
slope,
ca,
thal,
class,
restecg)
#Find
#1.The attribute type, e.g. nominal, ordinal, numeric
class(age)
class(sex)
class(cp)
class(trestbps)
class(cholestral)
class(bSugar)
class(restecg)
class(diastbpererc)
class(thalach)
class(exang)
class(oldpeak)
class(slope)
class(ca)
class(thal)
class(class)
#2.Percentage of missing values in the data
table(is.na(Cardiology))
percentageOf_missing_values<-(7/4613)*100
#3.Max, min, mean, mode, median standard deviation
summary(Cardiology)
#Function for the mode
Mode <- function(x)
{
ux<- unique(x)
ux[which.max(tabulate(match(x,ux)))]
}
Mode(age)
Mode(sex)
Mode(cp)
Mode(trestbps)
Mode(cholestral)
Mode(bSugar)
Mode(restecg)
Mode(diastbpererc)
Mode(thalach)
Mode(exang)
Mode(oldpeak)
Mode(slope)
Mode(ca)
Mode(thal)
Mode(class)
#Stanard Deviation
sd(age)
sd(trestbps)
sd(cholestral,na.rm = TRUE)
sd(diastbpererc)
sd(thalach)
sd(oldpeak)
#4.The type of distribution that the numeric attributes seem to follow (e.g. normal).
ad.test(age)
ad.test(cholestral)
ad.test(cholestral,na.rm = TRUE)
ad.test(cholestral, scientific = FALSE)
options(scipen=999)
ad.test(cholestral)
qqnorm(age)
qqnorm(age, col = "red")
qqnorm(age)
qqline(age,col = "red")
ad.test(cholestral)
ad.test(diastbpererc)
ad.test(oldpeak)
ad.test(thalach)
ad.test(trestbps)
shapiro.test(age)
shapiro.test(cholestral)
shapiro.test(diastbpererc)
shapiro.test(oldpeak)
shapiro.test(thalach)
shapiro.test(trestbps)
qqline(cholestral,col = "red")
qqline(diastbpererc,col = "red")
qqline(oldpeak,col = "red")
qqplot(cholestral)
qqline(cholestral,col = "red")
qqplot(cholestral)
qqnorm(cholestral)
qqline(cholestral,col = "red")
qqnorm(diastbpererc)
qqline(diastbpererc,col = "red")
qqnorm(oldpeak)
qqline(oldpeak,col = "red")
qqnorm(thalach)
qqline(thalach,col = "red")
qqnorm(trestbps)
qqline(trestbps,col = "red")
hist(trestbps)
hist(age)
hist(cholestral)
qqnorm(cholestral)
qqline(cholestral,col = "red")
qqnorm(diastbpererc)
qqline(diastbpererc,col = "red")
qqnorm(diastbpererc)
hist(diastbpererc)
#plotting for normaility
qqnorm(age)
qqline(age,col = "red")
hist(age)
qqnorm(cholestral)
qqline(cholestral,col = "red")
qqnorm(diastbpererc)
qqline(diastbpererc,col = "red")
hist(diastbpererc)
#
qqnorm(oldpeak)
qqline(oldpeak,col = "red")
hist(oldpeak)
qqnorm(thalach)
qqline(thalach,col = "red")
hist(thalach)
#not-normal
qqnorm(trestbps)
qqline(trestbps,col = "red")
hist(trestbps)
#5.Whether the numeric data is skewed and the type of skewness
skewness(age)
skewness(cholestral,na.rm = TRUE)
skewness(diastbpererc)
skewness(oldpeak)
skewness(thalach)
skewness(trestbps)
qqnorm(cholestral)
qqline(cholestral,col = "red")
hist(cholestral)
cor(Heart)
HeartCorr<-data.frame(age,
as.integer(sex),
as.integer(cp),
trestbps,
cholestral,
as.integer(bSugar),
diastbpererc,
thalach,
as.integer(exang),
oldpeak,
as.integer(slope),
as.integer(ca),
as.integer(thal),
as.integer(restecg))
M<-cor(HeartCorr)
corrplot(M,method = 'ellipse')
M
corrplot(M,type = "upper",method = 'number')
HeartCorr<-data.frame(age,
as.integer(sex),
as.integer(cp),
trestbps,
#cholestral,
as.integer(bSugar),
diastbpererc,
thalach,
as.integer(exang),
oldpeak,
as.integer(slope),
as.integer(ca),
as.integer(thal)
#as.integer(restecg)
)
M<-cor(HeartCorr)
corrplot(M,type = "upper",method = 'number')
HistogramOverlay <- function(nVal){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 3)+theme_bw()
}
HistogramOverlay(age)
HistogramOverlay <- function(nVal){
ggplot(Heart,aes(x=value,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 3)+theme_bw()
}
HistogramOverlay(age)
HistogramOverlay <- function(nVal){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 3)+theme_bw()
}
HistogramOverlay(age)
HistogramOverlay(cholestral)
HistogramOverlay(diastbpererc)
HistogramOverlay(oldpeak)
HistogramOverlay(thalach)
HistogramOverlay(trestbps)
PlotHistogram(health$age, "Age", 4)
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 3)+theme_bw()+ xlab(nVal)
#2 Histogram Overlay
HistogramOverlay <- function(nVal){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 3)+theme_bw()+ xlab(nVal)
}
HistogramOverlay(age)
HistogramOverlay(cholestral)
HistogramOverlay(diastbpererc)
HistogramOverlay(oldpeak)
HistogramOverlay(thalach)
HistogramOverlay(trestbps)
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 4)+theme_bw()+ xlab(label)
#2 Histogram Overlay
HistogramOverlay <- function(nVal,label){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 4)+theme_bw()+ xlab(label)
}
HistogramOverlay(age,"Age")
HistogramOverlay(cholestral,"cholestral")
HistogramOverlay(diastbpererc,"Diastolic blood pressure during excercise")
HistogramOverlay(oldpeak,"oldpeak")
HistogramOverlay(thalach,"Max Heart Rate")
HistogramOverlay(trestbps,"Resting blood pressure")
HistogramOverlay <- function(nVal,label,Width){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binWidth = Width)+theme_bw()+ xlab(label)
}
HistogramOverlay(cholestral,"cholestral",40)
#2 Histogram Overlay
HistogramOverlay <- function(nVal,label,binW){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binWidth = binW)+theme_bw()+ xlab(label)
}
HistogramOverlay(cholestral,"cholestral",40)
HistogramOverlay(cholestral,"cholestral",40)
HistogramOverlay <- function(nVal,label){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 4)+theme_bw()+ xlab(label)
}
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 40)+theme_bw()+ xlab(label)
ggplot(Heart,aes(x=cholestral,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 40)+theme_bw()+ xlab("cholestral")
#separate call on cholestral to fix binwidth
ggplot(Heart,aes(x=cholestral,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 40)+theme_bw()+ xlab("cholestral")
HistogramOverlay(age,"Age")
HistogramOverlay(diastbpererc,"Diastolic blood pressure during excercise")
HistogramOverlay(oldpeak,"oldpeak")
HistogramOverlay(thalach,"Max Heart Rate")
ggplot(Heart,aes(x=thalach,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 40)+theme_bw()+ xlab("Max Heart Rate")
HistogramOverlay(trestbps,"Resting blood pressure")
HistogramOverlay <- function(nVal,label){
ggplot(Heart,aes(x=nVal,fill=class))+
geom_histogram(position = "identity",alpha=0.4,binwidth = 8)+theme_bw()+ xlab(label)
}
HistogramOverlay(trestbps,"Resting blood pressure")
BarChartOverlay<- function(cVal){
ggplot(data,aes(x=cVal,fill=class))+
geom_bar(position = "identity",alpha=0.4)+theme_bw()
}
BarChartOverlay(class)
BarChartOverlay(cp)
BarChartOverlay(exang)
BarChartOverlay<- function(cVal){
ggplot(Health,aes(x=cVal,fill=class))+
geom_bar(position = "identity",alpha=0.4)+theme_bw()
}
BarChartOverlay(cp)
BarChartOverlay<- function(cVal){
ggplot(Heart,aes(x=cVal,fill=class))+
geom_bar(position = "identity",alpha=0.4)+theme_bw()
}
BarChartOverlay(cp)
BarChartOverlay(bSugar)
BarChartOverlay(exang)
BarChartOverlay(slope)
BarChartOverlay(ca)
BarChartOverlay(thal)
BarChartOverlay(sex)
BarChartOverlay(restecg)
BarChartOverlay<- function(cVal,label){
ggplot(Heart,aes(x=cVal,fill=class))+
geom_bar(position = "identity",alpha=0.4)+theme_bw()+ xlab(label)
}
BarChartOverlay(cp,"Chest pain type")
BarChartOverlay(bSugar,"Fasting Blood Sugar")
BarChartOverlay(cp,"Chest pain type")
BarChartOverlay(bSugar,"Fasting Blood Sugar")
BarChartOverlay(exang,"Exercise induced angina")
BarChartOverlay(slope,"The slope of the peak exercise")
BarChartOverlay(ca,"Number of major vessels")
BarChartOverlay(thal,"thal")
BarChartOverlay(sex,"Gender")
BarChartOverlay(restecg,"Resting electrocardiographic results")
quantile(health$cholesterol, na.rm = TRUE)
quantile(Cardiology$cholesterol, na.rm = TRUE)
boxplot(age)
boxplot(trestbps)
boxplot(cholestral)
boxplot(diastbpererc)
boxplot(thalach)
boxplot(oldpeak)
boxplot(age,main="age")
boxplot(trestbps,main="trestbps")
boxplot(cholestral,main="cholestral")
boxplot(diastbpererc,main="diastbpererc")
boxplot(thalach,main="thalach")
boxplot(oldpeak,main="oldpeak")
BarChartOutlier<- function(oVal){
ggplot(data,aes(x=oVal))+
geom_bar()
}
BarChartOutlier(class)
ggplot(Heart,aes(x=oVal))+
geom_bar()
BarChartOutlier<- function(oVal){
ggplot(Heart,aes(x=oVal))+
geom_bar()
}
BarChartOutlier(class)
BarChartOutlier(cp)
BarChartOutlier(bSugar)
BarChartOutlier(exang)
BarChartOutlier(slope)
BarChartOutlier(ca)
BarChartOutlier(thal)
BarChartOutlier(sex)
BarChartOutlier(class)
BarChartOutlier(cp)
BarChartOutlier(bSugar)
BarChartOutlier(exang)
BarChartOutlier(slope)
BarChartOutlier(ca)
BarChartOutlier(thal)
BarChartOutlier(restecg)
trestbps_sd <- sd(trestbps)
trestbps_mean<-mean(trestbps)
z<-(180-trestbps_mean)/trestbps_sd
z
quantile(trestbps)
IQR(trestbps)
140+(1.5*20)
trestbps
table(trestbps)
z<-(200-trestbps_mean)/trestbps_sd
z
z<-(192-trestbps_mean)/trestbps_sd
z
quantile(trestbps)
140+(1.5*20)
trestbps_sd <- sd(trestbps)
trestbps_mean<-mean(trestbps)
z<-(192-trestbps_mean)/trestbps_sd
z
#Z-score test
trestbps_sd <- sd(trestbps)
trestbps_mean<-mean(trestbps)
z<-(192-trestbps_mean)/trestbps_sd
z
#IQR Test
quantile(trestbps)
IQR(trestbps)
140+(1.5*20)
# scatter plots numeric only need to finish
scatterPlot(trestbps,age)
#5
# scatter function plot for correlation
scatterPlot<-function(v1,v2)
{
ggplot(data,aes(x=v1,v2))+
geom_point(size=1)+
geom_smooth(method = "lm", se = FALSE)
}
# scatter plots numeric only need to finish
scatterPlot(trestbps,age)
ggplot(Heart,aes(x=v1,v2))+
geom_point(size=1)+
geom_smooth(method = "lm", se = FALSE)
#5
# scatter function plot for correlation
scatterPlot<-function(v1,v2)
{
ggplot(Heart,aes(x=v1,v2))+
geom_point(size=1)+
geom_smooth(method = "lm", se = FALSE)
}
# scatter plots numeric only need to finish
scatterPlot(trestbps,age)
scatterPlot<-function(v1,v2,xVal,yVal)
{
ggplot(Heart,aes(x=v1,v2))+
geom_point(size=1)+
geom_smooth(method = "lm", se = FALSE)
+ xlab(xVal) + ylab(yVal)
}
# scatter plots numeric only need to finish
scatterPlot(trestbps,age,"Resting Blood Pressure","age")
scatterPlot<-function(v1,v2,xVal,yVal)
{
ggplot(Heart,aes(x=v1,v2))+
geom_point(size=1)+ xlab(xVal) + ylab(yVal)+
geom_smooth(method = "lm", se = FALSE)
}
# scatter plots numeric only need to finish
scatterPlot(trestbps,age,"Resting Blood Pressure","age")
scatterPlot(age,diastbpexerc)
scatterPlot(trestbps,cholesterol,"Resting Blood Pressure")
scatterPlot(trestbps,cholesterol,"Resting Blood Pressure","cholesterol")
scatterPlot<-function(v1,v2,xVal,yVal)
{
ggplot(Heart,aes(x=v1,v2))+
geom_point(size=1)+ xlab(xVal) + ylab(yVal)+
geom_smooth(method = "lm", se = FALSE)
}
# scatter plots numeric only need to finish
scatterPlot(trestbps,age,"Resting Blood Pressure","age")
scatterPlot(trestbps,cholesterol,"Resting Blood Pressure","cholesterol")
scatterPlot(trestbps,cholestral,"Resting Blood Pressure","cholestral")
scatterPlot(trestbps,diastbpexerc,"Resting Blood Pressure","diastbpexerc")
scatterPlot(trestbps,diastbpererc,"Resting Blood Pressure","diastbpererc")
#scatterPlot(trestbps,diastbpererc,"Resting Blood Pressure","diastbpererc")
scatterPlot(trestbps,thalach,"Resting Blood Pressure","thalach")
scatterPlot(trestbps,oldpeak,"Resting Blood Pressure","oldpeak")
scatterPlot(age,cholestral,"age","cholestral")
scatterPlot(age,diastbpererc,"age","diastbpererc")
scatterPlot(age,thalach,"age","thalach")
scatterPlot(age,oldpeak,"age","oldpeak")
scatterPlot(cholestral,diastbpererc,"cholestral","diastbpererc")
scatterPlot(cholestral,thalach,"cholestral","thalach")
scatterPlot(cholestral,oldpeak,"cholestral","oldpeak")
scatterPlot(oldpeak,diastbpererc,"oldpeak","diastbpererc")
scatterPlot(oldpeak,thalach,"oldpeak","thalach")
#verify correlation
corr(trestbps,diastbpererc)
#verify correlation
corr(trestbps,diastbpererc);
#verify correlation
cor(trestbps,diastbpererc);
#verify correlation
cor(trestbps,diastbpererc,method = c("pearson"));
cor(trestbps,diastbpererc,method = c("kendall"));
cor(trestbps,diastbpererc,method = c("spearman"));
#######PART 2#######
#install.packages("classInt",dependencies = TRUE)
#library(classInt)
n<-length(age)
#Declare number of bins and bin indicator
nbins<-4
whichbin<-c(rep(0,n))
whichbin
#Equal Frequencey(Equal Depth)
freq<-n/nbins
#sort the data
xsorted<-sort(age)
for (i in 1:nbins)
{
for(j in 1:n)
{
if((i-1)*freq<j&&j<=i*freq)
whichbin[j]<-i
}
}
whichbin
xsorted
#K-means clustering as a binning strategy where k=4
kmeansclustering<- kmeans(age,centers = nbins)
which<-kmeansclustering$cluster
which
age
#7.Skewness
#Z-score stanard
z.oldpeak<- scale(oldpeak, center = TRUE, scale = TRUE)
#7.Skewness
#Z-score stanard
skewness(oldpeak)
skewness(z.oldpeak)
#Square Root
sq.oldpeak<-sqrt(Cardiology$oldpeak)
skewness(oldpeak)
natlog.oldpeak<-log(Cardiology$oldpeak)
natlog.oldpeak
skewness(natlog.oldpeak)
#Inverse
invsqrt.oldpeak<-1/sqrt(Cardiology$oldpeak)
invsqrt.oldpeak
skewness(invsqrt.oldpeak)
#Square Root
sq.oldpeak<-sqrt(Cardiology$oldpeak)
skewness(sq.oldpeak)
